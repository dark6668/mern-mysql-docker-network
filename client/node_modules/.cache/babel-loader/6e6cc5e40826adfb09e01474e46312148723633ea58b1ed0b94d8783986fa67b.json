{"ast":null,"code":"import { jwtDecode } from \"jwt-decode\";\nexport default class Utility {\n  static async FetchRequest(request) {\n    try {\n      return new Promise((resolve, reject) => {\n        fetch(`${process.env.REACT_APP_API_URL}/${request.url}`, {\n          method: request.method,\n          body: request.method === \"GET\" ? null : request.body,\n          headers: {\n            \"Content-Type\": request.ContentType,\n            ...(request.Authorization && {\n              Authorization: request.Authorization\n            })\n          }\n        }).then(async response => {\n          if (!response.ok) {\n            const errorData = await response.json();\n            reject(errorData);\n            return;\n          }\n          const responseData = await response.json();\n          resolve(responseData);\n        }).catch(err => {\n          console.error(\"Error in FetchRequest:\", err);\n          if (err.message === \"Failed to fetch\") {\n            alert(\"Something went wrong.\");\n          }\n          reject({\n            error: err\n          });\n        });\n      });\n    } catch (error) {\n      console.error(\"Unexpected error in FetchRequest:\", error);\n      alert(\"Something went wrong.\");\n      throw error; // Rethrow the error to ensure it's not silently ignored\n    }\n  }\n  static UserUnauthorized() {\n    sessionStorage.removeItem(\"accessToken\");\n    sessionStorage.removeItem(\"refreshToken\");\n    alert(\"Unauthorized\");\n    window.location.reload();\n  }\n  static CheckAccessTokenExpiresIn() {\n    return new Promise((resolve, reject) => {\n      try {\n        const decodedToken = jwtDecode(sessionStorage.getItem(\"accessToken\"));\n        const expirationTime = decodedToken.exp * 1000;\n        if (expirationTime < Date.now()) return resolve(\"Access token has expired\");\n        resolve(decodedToken);\n      } catch (error) {\n        reject(new Error(\"Failed to decode access token\"));\n      }\n    });\n  }\n  static async getNewAccessToken() {\n    return new Promise(async (resolve, reject) => {\n      try {\n        const request = {\n          method: \"GET\",\n          url: \"api/auth/getNewaAccessToken\",\n          ContentType: \"application/json; charset=UTF-8\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"refreshToken\")}`\n        };\n        await this.FetchRequest(request).then(result => {\n          sessionStorage.removeItem(\"accessToken\");\n          sessionStorage.setItem(\"accessToken\", result.accessToken);\n          resolve(false);\n        });\n      } catch (error) {\n        console.error(error);\n        reject(true);\n      }\n    });\n  }\n}","map":{"version":3,"names":["jwtDecode","Utility","FetchRequest","request","Promise","resolve","reject","fetch","process","env","REACT_APP_API_URL","url","method","body","headers","ContentType","Authorization","then","response","ok","errorData","json","responseData","catch","err","console","error","message","alert","UserUnauthorized","sessionStorage","removeItem","window","location","reload","CheckAccessTokenExpiresIn","decodedToken","getItem","expirationTime","exp","Date","now","Error","getNewAccessToken","result","setItem","accessToken"],"sources":["/react/src/function/utility.js"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\n\nexport default class Utility {\n  static async FetchRequest(request) {\n    try {\n      return new Promise((resolve, reject) => {\n        fetch(`${process.env.REACT_APP_API_URL}/${request.url}`, {\n          method: request.method,\n          body: request.method === \"GET\" ? null : request.body,\n          headers: {\n            \"Content-Type\": request.ContentType,\n            ...(request.Authorization && { Authorization: request.Authorization }),\n          },\n        })\n          .then(async (response) => {\n            if (!response.ok) {\n              const errorData = await response.json();\n              reject(errorData);\n              return;\n            }\n  \n            const responseData = await response.json();\n            resolve(responseData);\n          })\n          .catch((err) => {\n            console.error(\"Error in FetchRequest:\", err);\n  \n            if (err.message === \"Failed to fetch\") {\n              alert(\"Something went wrong.\");\n            }\n  \n            reject({ error: err });\n          });\n      });\n    } catch (error) {\n      console.error(\"Unexpected error in FetchRequest:\", error);\n      alert(\"Something went wrong.\");\n      throw error; // Rethrow the error to ensure it's not silently ignored\n    }\n  }\n  \n\n  static UserUnauthorized() {\n    sessionStorage.removeItem(\"accessToken\");\n    sessionStorage.removeItem(\"refreshToken\");\n    alert(\"Unauthorized\");\n    window.location.reload();\n  }\n\n  static CheckAccessTokenExpiresIn() {\n    return new Promise((resolve, reject) => {\n      try {\n        const decodedToken = jwtDecode(sessionStorage.getItem(\"accessToken\"));\n        const expirationTime = decodedToken.exp * 1000;\n        if (expirationTime < Date.now())\n          return resolve(\"Access token has expired\");\n        resolve(decodedToken);\n      } catch (error) {\n        reject(new Error(\"Failed to decode access token\"));\n      }\n    });\n  }\n  static async getNewAccessToken() {\n    return new Promise(async (resolve, reject) => {\n      try {\n        const request = {\n          method: \"GET\",\n          url: \"api/auth/getNewaAccessToken\",\n          ContentType: \"application/json; charset=UTF-8\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"refreshToken\")}`,\n        };\n        await this.FetchRequest(request).then((result) => {\n          sessionStorage.removeItem(\"accessToken\");\n          sessionStorage.setItem(\"accessToken\", result.accessToken);\n          resolve(false);\n        });\n      } catch (error) {\n        console.error(error);\n        reject(true);\n      }\n    });\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}