{"ast":null,"code":"import { jwtDecode } from \"jwt-decode\";\nexport default class Utility {\n  static async FetchRequest(request) {\n    return new Promise((resolve, reject) => {\n      fetch(`${process.env.REACT_APP_API_URL}/${request.url}`, {\n        method: request.method,\n        body: request.method === \"GET\" ? null : request.body,\n        headers: {\n          \"Content-Type\": request.ContentType,\n          ...(request.Authorization !== undefined && {\n            \"Authorization\": request.Authorization\n          })\n        }\n      }).then(response => {\n        if (response.status !== 200) {\n          response.json().then(errorData => {\n            reject(errorData);\n          });\n          return;\n        }\n        response.json().then(responseData => {\n          resolve(responseData);\n        }).catch(err => {\n          reject(err);\n        });\n      }).catch(err => {\n        if (err.message === \"Failed to fetch\") {\n          alert(\"Something went wrong.\");\n        }\n        reject({\n          error: err\n        });\n      });\n    });\n  }\n  static UserUnauthorized() {\n    sessionStorage.removeItem(\"accessToken\");\n    sessionStorage.removeItem(\"refreshToken\");\n    alert(\"Unauthorized\");\n    window.location.reload();\n  }\n  static CheckAccessTokenExpiresIn() {\n    return new Promise((resolve, reject) => {\n      try {\n        const decodedToken = jwtDecode(sessionStorage.getItem(\"accessToken\"));\n        const expirationTime = decodedToken.exp * 1000;\n        console.log(expirationTime < Date.now());\n        if (expirationTime < Date.now()) return resolve(\"Access token has expired\");\n        resolve(decodedToken);\n      } catch (error) {\n        reject(new Error(\"Failed to decode access token\"));\n      }\n    });\n  }\n  static async getNewAccessToken(newAccessToken) {\n    return new Promise((resolve, reject) => {\n      try {\n        const request = {\n          method: \"POST\",\n          url: \"api/auth/getNewaAccessToken\",\n          body: JSON.stringify({\n            test: \"tere\"\n          }),\n          ContentType: \"application/json; charset=UTF-8\",\n          Authorization: `Bearer ${sessionStorage.getItem(\"refreshToken\")}`\n        };\n        this.FetchRequest(request).then(result => {\n          sessionStorage.removeItem(\"accessToken\");\n          sessionStorage.setItem(\"accessToken\", newAccessToken);\n          resolve(true);\n        });\n      } catch (error) {\n        console.error(error);\n        reject(false);\n      }\n    });\n  }\n}","map":{"version":3,"names":["jwtDecode","Utility","FetchRequest","request","Promise","resolve","reject","fetch","process","env","REACT_APP_API_URL","url","method","body","headers","ContentType","Authorization","undefined","then","response","status","json","errorData","responseData","catch","err","message","alert","error","UserUnauthorized","sessionStorage","removeItem","window","location","reload","CheckAccessTokenExpiresIn","decodedToken","getItem","expirationTime","exp","console","log","Date","now","Error","getNewAccessToken","newAccessToken","JSON","stringify","test","result","setItem"],"sources":["/react/src/function/utility.js"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\n\nexport  default class Utility{\n\n  static async FetchRequest(request) {\n    return new Promise((resolve, reject) => {\n      fetch(`${process.env.REACT_APP_API_URL}/${request.url}`, {\n        method: request.method,\n        body: request.method === \"GET\" ? null : request.body,\n        headers: {\n          \"Content-Type\": request.ContentType,\n          ...(request.Authorization !== undefined && { \"Authorization\": request.Authorization }),\n        },\n      })\n        .then((response) => {\n          if (response.status !== 200) {\n            response.json().then((errorData) => {\n              reject(errorData);\n            });\n            return;\n          }\n          response\n            .json()\n            .then((responseData) => {\n              resolve(responseData);\n            })\n            .catch((err) => {\n              reject(err);\n            });\n        })\n        .catch((err) => {\n          if (err.message === \"Failed to fetch\") {\n            alert(\"Something went wrong.\");\n          }\n          reject({ error: err });\n        });\n    });\n  }\n\n  static UserUnauthorized (){\n    sessionStorage.removeItem(\"accessToken\");\n    sessionStorage.removeItem(\"refreshToken\");\n    alert(\"Unauthorized\")\n    window.location.reload();\n  }\n\n  static CheckAccessTokenExpiresIn(){\n    return new Promise((resolve, reject) => {\n      try {\n        const decodedToken = jwtDecode(sessionStorage.getItem(\"accessToken\"));\n  \n        const expirationTime = decodedToken.exp * 1000;\n        console.log(expirationTime < Date.now());\n        if (expirationTime < Date.now()) return resolve(\"Access token has expired\");\n        resolve(decodedToken);\n      } catch (error) {\n        reject(new Error(\"Failed to decode access token\"));\n      }\n    });\n  }\n  static async getNewAccessToken(newAccessToken){\n    return new Promise((resolve, reject) => {\n      try {\n    const request = {\n      method: \"POST\",\n      url: \"api/auth/getNewaAccessToken\" ,\n      body: JSON.stringify({ test: \"tere\" }),\n      ContentType: \"application/json; charset=UTF-8\",\n      Authorization: `Bearer ${sessionStorage.getItem(\"refreshToken\")}`};\n      this.FetchRequest(request).then((result)=>{\n\n        sessionStorage.removeItem(\"accessToken\");\n        sessionStorage.setItem(\"accessToken\", newAccessToken);\n        resolve(true);\n        \n      })\n    } catch (error) {\n      console.error(error);\n      reject(false);\n    }\n  });\n  }\n}\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}